# Лабораторная работа №2* (со звездочкой)
Что надо сделать:
1. Написать “плохой” Docker compose файл, в котором есть не менее трех “bad practices” по их написанию
2. Написать “хороший” Docker compose файл, в котором эти плохие практики исправлены
3. В Readme описать каждую из плохих практик в плохом файле, почему она плохая и как в хорошем она была исправлена, как исправление повлияло на результат
4. После предыдущих пунктов в хорошем файле настроить сервисы так, чтобы контейнеры в рамках этого compose-проекта так же поднимались вместе, но не "видели" друг друга по сети. В отчете описать, как этого добились и кратко объяснить принцип такой изоляции



## "Плохой" Docker compose файл:
Сначала проверим, установлен ли Docker Compose с помощью команды `docker-compose --version`.
![Image alt](https://github.com/lisalaktionova/itmo_devops-clouds/blob/main/DevOps/Laba_2*/check%20docker%20compose.png)

Docker compose уже установлен:)

С помощью команды nano создаем и открываем файл bad Dockerfile в текстовом редакторе терминала. Далее пишим "плохой" Dockerfile, который поднимает два сервиса — Nginx и MySQL.

![Image alt](https://github.com/lisalaktionova/itmo_devops-clouds/blob/main/DevOps/Laba_2*/bad.png)

Какие 'bad practices' есть в этом Docker comspose:
1. **Использование "latest" для версий образов**

Образ с тегом `latest` всегда будет автоматически обновляться до самой последней версии. Если выйдет новая версия с несовместимыми изменениями, это может привести к тому, что приложение сломается при запуске или обновлении контейнера.

2. **Хранение конфиденциальных данных в коде**

Не безопасно хранить пароли, токены и другую конфиденциальную информацию в Docker compose файле или в переменных окружения. Если кто-то получит доступ к Docker Compose файлу, он также получит доступ к паролям и другим конфиденциальным данным.

3. **Отсутствие сети для изоляции сервисов**

Если контейнеры работают в одной сети, они могут взаимодействовать друг с другом даже тогда, когда это не требуется, что увеличивает риск нежелательных взаимодействий.

  
## "Хороший" Docker compose файл:
В хорошем Dockercompose файле были исправлены все плохие практики.

![Image alt](https://github.com/lisalaktionova/itmo_devops-clouds/blob/main/DevOps/Laba_2*/good.png)

Как были исправлены плохие практики:

1. **Использование "latest" для версий образов**

Вместо тега `latest`, указываем конкретную версию образа,  что гарантирует стабильность и предсказуемость работы приложения. Это позволяет контролировать, когда и как обновляются образы, и проверять их на совместимость перед обновлением.

2. **Хранение конфиденциальных данных в коде**

Для хранения конфиденциальных данных будем использовать Docker Secrets . `Docker Secrets` - это механизм, позволяющий безопасно хранить и управлять конфиденциальной информацией в зашифрованном виде и передавать ее в контейнеры во время их работы. Теперь вместо того, чтобы напрямую указывать пароль, будем передавать его через секрет (password), который хранится за пределами файла Docker Compose.

3. **Отсутствие сети для изоляции сервисов**

Разделяли сервисы по разным сетям, чтобы изолировать их друг от друга. Теперь контейнеры, находящиеся в разных сетях, не могут взаимодействовать напрямую, что увеличивает безопасность и позволяет четко управлять взаимодействием между сервисами. 
     

## Изоляция контейнеров

Чтобы контейнеры не могли "видеть" друг друга по сети, мы добавили для каждого сервиса свою отдельную сеть в "хорошем" Docker compose файле:

- app_network для сервиса app
- db_network для сервиса db
  
 **Принцип изоляции:** Docker создает виртуальные сети для контейнеров. Если контейнеры находятся в разных сетях, они не могут обращаться друг к другу по имени сервиса или IP-адресу, что создаёт дополнительный уровень защиты.
   
